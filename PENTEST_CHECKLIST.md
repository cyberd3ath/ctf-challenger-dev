# CTF Hosting Platform Penetration Testing Checklist

This checklist covers a comprehensive pentest for a CTF hosting platform with Proxmox hosts, OpenVPN, web/database VMs, challenge VMs, and firewall rules.

---

## 1. Host / Hypervisor (Proxmox) Security
- [x] **Proxmox Version & Patch Status**
    - [x] Check latest security updates
    - [x] Verify known CVEs
- [x] **Access Control**
    - [x] Strong admin passwords
- [x] **Network Exposure**
    - [x] Management interface not publicly accessible
- [ ] **VM Isolation**
    - [ ] Verify VM-to-host escape prevention
    - [ ] Check CPU/memory sharing configurations
- [ ] **Logs & Monitoring**
    - [ ] Audit Proxmox logs for unusual activity

---

## 2. Network & VPN (OpenVPN)
- [ ] **Authentication & Encryption**
    - [ ] Strong TLS cipher suites
    - [ ] Proper certificate/key management
    - [ ] Check for weak/expired keys
- [ ] **Access Control**
    - [ ] VPN clients cannot reach host management
    - [ ] Client-to-client restrictions enforced
- [ ] **Network Segmentation**
    - [ ] Verify challenge VM subnet isolation
    - [ ] Firewall rules prevent unwanted communication
- [ ] **VPN Vulnerabilities**
    - [ ] Check misconfigurations (redirect-gateway, etc.)
    - [ ] Test for DNS/IP leaks

---

## 3. Firewall Rules
- [ ] **Inbound Rules**
    - [ ] Only necessary ports open
    - [ ] Block all unused ports
- [ ] **Outbound Rules**
    - [ ] Prevent VMs from scanning host network
    - [ ] Restrict challenge VMs from reaching each other
- [ ] **Segmentation Validation**
    - [ ] Attempt lateral movement between VMs
    - [ ] Test isolation of restricted subnets

---

## 4. Web Server VM
- [ ] **OS & Packages**
    - [ ] Patches up-to-date
    - [ ] Unnecessary services disabled
- [ ] **HTTP(S) Configuration**
    - [ ] SSL/TLS properly configured
    - [ ] Security headers (HSTS, CSP, X-Frame-Options)
- [ ] **Authentication**
    - [ ] Secure password storage
    - [ ] Brute-force protections
- [ ] **Common Web Vulnerabilities**
    - [ ] SQL Injection
    - [ ] XSS, CSRF
    - [ ] File upload vulnerabilities
    - [ ] Directory traversal
    - [ ] Session management flaws
    - [ ] Sensitive data exposure
- [ ] **APIs**
    - [ ] Auth & authorization checks
    - [ ] Rate-limiting & input validation
- [ ] **Access from Challenge VMs**
    - [ ] Verify backend/admin protection

---

## 5. Database VM
- [ ] **DB Configuration**
    - [ ] Not publicly accessible
    - [ ] Least-privilege accounts
    - [ ] Remote root/admin disabled
- [ ] **Authentication**
    - [ ] Strong passwords
    - [ ] Encrypted connections enforced
- [ ] **SQL Injection**
    - [ ] Test inputs from web interface
    - [ ] Ensure prepared statements/ORM usage
- [ ] **Backups & Sensitive Data**
    - [ ] Check backup permissions
    - [ ] Ensure no hard-coded credentials

---

## 6. Challenge VMs
- [ ] **OS & Patch Status**
    - [ ] Minimal OS
    - [ ] Updated packages
- [ ] **Network Restrictions**
    - [ ] Isolated VLAN/subnet
    - [ ] Cannot reach host, web, DB unless required
- [ ] **Privilege Escalation**
    - [ ] Test common kernel/sudo exploits
    - [ ] Ensure no VM breakout
- [ ] **Persistence / Sandbox Escape**
    - [ ] Verify no host or other VM compromise
- [ ] **Monitoring**
    - [ ] Log connections & suspicious activity
    - [ ] Alert on abnormal outbound traffic

---

## 7. Internal Isolation & Multi-Tenancy
- [ ] **Participant Isolation**
    - [ ] Users cannot access othersâ€™ challenges
    - [ ] VPN and firewall segmentation effective
- [ ] **Filesystem Isolation**
    - [ ] Challenge VMs cannot access host filesystem
    - [ ] Web/DB VMs have minimal exposure

---

## 8. Logging, Monitoring, and Incident Response
- [ ] **Centralized Logging**
    - [ ] Host, VMs, VPN logs collected
    - [ ] Monitor failed logins & abnormal traffic
- [ ] **Alerting**
    - [ ] Detect unusual outbound/inbound traffic
    - [ ] Suspicious admin panel activity alerts

---

## 9. Optional Advanced Testing
- [ ] **Penetration Testing Tools**
    - [ ] Nmap, Nessus/OpenVAS
    - [ ] Metasploit
    - [ ] Burp Suite
- [ ] **Fuzzing**
    - [ ] Buffer overflow and unexpected input testing
- [ ] **Configuration Audits**
    - [ ] CIS Benchmarks (Linux/Proxmox)
    - [ ] Docker/LXC security guidelines if applicable
- [ ] **Red Team Simulation**
    - [ ] Attempt pivot from one VM to host/other VMs
    - [ ] Simulate participant attacks on other challenges

---

### Key Principles
1. **Defense in Depth:** Multiple layers of protection.
2. **Segmentation & Isolation:** Prevent user impact on host/other users.
3. **Least Privilege:** Only grant required permissions.
4. **Monitoring & Recovery:** Logs, alerts, backups validated.
5. **Regular Testing:** Repeat pentesting after updates or new challenges.
